<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Broncopolmonite Infettiva - Medicina Interna Veterinaria</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Lexend:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f0fdfa; color: #134e4a; }
        .content-section { background-color: #ffffff; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
        .nav-link { transition: all 0.2s; border-bottom: 2px solid transparent; }
        .nav-link:hover, .nav-link.active { border-bottom-color: #0d9488; color: #0f766e; }
        .dsa-mode {
            font-family: 'Lexend', sans-serif;
            background-color: #fdfaf5 !important;
            letter-spacing: 0.05em;
            line-height: 1.75;
            color: #34495e;
        }
        .dsa-mode #main-header, .dsa-mode #main-footer { background-color: #000000 !important; }
        .dsa-mode #main-header h1, .dsa-mode #main-header a, .dsa-mode #main-footer p, .dsa-mode button { color: #ffffff !important; }
        .dsa-mode button { border: 1px solid #ffffff; }
        .dsa-mode .content-section { background-color: #fffdfa; border: 1px solid #e0e0e0; }
        .dsa-mode h1, .dsa-mode h2, .dsa-mode h3, .dsa-mode p, .dsa-mode li { color: #34495e; }
        .tts-button { cursor: pointer; display: inline-block; margin-left: 10px; vertical-align: middle; color: #64748b; transition: color 0.2s; }
        .tts-button:hover, .tts-button.playing { color: #0ea5e9; }
        .quiz-question { border: 1px solid #ccfbf1; transition: all 0.3s; }
        .quiz-option:hover { background-color: #f0fdfa; }
        .quiz-question.correct { background-color: #d1fae5; border-color: #10b981; }
        .quiz-question.incorrect { background-color: #fee2e2; border-color: #ef4444; }
        @media print {
            #main-header, #main-footer, #page-nav, #infografica, #quiz, #audio, #print-button, .tts-button, video, img, a[href*="infografica"] { display: none; }
        }
    </style>
</head>
<body class="bg-teal-50">

    <header id="main-header" class="bg-teal-800 text-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center flex-wrap">
            <h1 class="text-xl font-bold !text-white !border-none !m-0 !p-0 !text-left" data-lang-key="siteTitle">Patologie Respiratorie</h1>
            <div class="flex items-center space-x-4">
                <button id="accessibility-toggle" aria-label="Attiva modalit√† ad alta leggibilit√†" class="text-sm font-semibold px-3 py-2 rounded-lg bg-white/20 hover:bg-white/30 transition" data-lang-key="accessibility">Accessibilit√†</button>
                <button id="lang-toggle" aria-label="Change language" class="text-sm font-semibold px-3 py-2 rounded-lg bg-white/20 hover:bg-white/30 transition">EN</button>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-10">
        <div class="text-left mb-8">
            <a href="index.html" class="inline-flex items-center bg-white text-teal-700 font-bold py-2 px-4 rounded-lg shadow hover:bg-teal-100 transition duration-300" data-lang-key="backToIndex">
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.707-10.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L9.414 11H13a1 1 0 100-2H9.414l1.293-1.293z" clip-rule="evenodd"></path></svg>
                <span data-lang-key="backToIndexText">Indice Patologie Respiratorie</span>
            </a>
        </div>
        
        <div class="content-section p-6 md:p-10">
            <header class="text-center border-b-2 border-teal-200 pb-6 mb-8">
                <h1 class="text-4xl md:text-5xl font-bold text-teal-800" data-lang-key="pageTitle">Broncopolmonite Infettiva</h1>
                <p class="text-lg text-teal-700 mt-2" data-lang-key="pageSubtitle">Gestione delle infezioni polmonari in diverse specie.</p>
            </header>

            <nav id="page-nav" class="flex justify-center flex-wrap gap-4 md:gap-8 mb-10 border-b border-gray-200">
                <a href="#riassunto" class="nav-link font-semibold py-2" data-lang-key="navSummary">Riassunto</a>
                <a href="#infografica" class="nav-link font-semibold py-2" data-lang-key="navInfographic">Infografica</a>
                <a href="#quiz" class="nav-link font-semibold py-2" data-lang-key="navQuiz">Quiz</a>
                <a href="#audio" class="nav-link font-semibold py-2" data-lang-key="navAudio">Audio</a>
                <a href="#bibliografia" class="nav-link font-semibold py-2" data-lang-key="navBibliography">Bibliografia</a>
            </nav>

            <article class="space-y-12">
                <section id="riassunto">
                    <h2 class="text-3xl font-bold text-teal-700 mb-4 flex items-center" data-lang-key="summaryTitle">Riassunto Completo <span class="tts-button"><svg class="w-7 h-7" fill="currentColor" viewBox="0 0 20 20"><path d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.414z"/></svg></span></h2>
                    <div class="prose max-w-none text-teal-900" data-lang-key="summaryContent">
                        <!-- Content loaded by JS -->
                    </div>
                </section>

                <section id="infografica">
                    <h2 class="text-3xl font-bold text-teal-700 mb-4" data-lang-key="infographicTitle">Infografica Riepilogativa</h2>
                     <a href="infografica_broncopolmonite.html" target="_blank" class="block bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow border-l-4 border-teal-500">
                        <div class="flex items-center space-x-6">
                            <div class="flex-shrink-0 w-24 h-24 bg-teal-500 rounded-lg flex items-center justify-center">
                                <span class="text-5xl" role="img" aria-label="Icona di un microbo">ü¶†</span>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-teal-800" data-lang-key="infographicLinkTitle">Visualizza l'Infografica Dettagliata</h3>
                                <p class="text-gray-600 mt-1" data-lang-key="infographicLinkDesc">Clicca qui per una guida visuale completa sulla broncopolmonite infettiva.</p>
                            </div>
                        </div>
                    </a>
                </section>

                <section id="quiz">
                    <h2 class="text-3xl font-bold text-teal-700 mb-4" data-lang-key="quizTitle">Quiz di Autovalutazione</h2>
                    <div id="quiz-container" class="space-y-6">
                        <!-- Questions loaded by JS -->
                    </div>
                    <div class="mt-6 text-center">
                        <button id="submit-quiz" class="bg-teal-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-teal-700 transition" data-lang-key="quizSubmit">Verifica Risposte</button>
                    </div>
                    <div id="quiz-results" class="mt-6 text-center text-xl font-bold"></div>
                </section>

                <section id="audio">
                    <h2 class="text-3xl font-bold text-teal-700 mb-4" data-lang-key="audioTitle">Ascolta il Riassunto</h2>
                    <div class="p-4 bg-teal-100/50 rounded-lg flex flex-col sm:flex-row items-center gap-4 w-full">
                        <button id="audio-play-pause" class="p-3 bg-teal-500 text-white rounded-full hover:bg-teal-600 transition-colors duration-200">
                            <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M6.3 2.841A1.5 1.5 0 004 4.11v11.78a1.5 1.5 0 002.3 1.27l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z" />
                            </svg>
                            <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 hidden" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M5.75 4.5a.75.75 0 00-.75.75v10a.75.75 0 001.5 0v-10a.75.75 0 00-.75-.75zM14.25 4.5a.75.75 0 00-.75.75v10a.75.75 0 001.5 0v-10a.75.75 0 00-.75-.75z" />
                            </svg>
                        </button>
                        <div class="flex-grow text-center sm:text-left">
                            <p class="font-semibold text-teal-800" data-lang-key="audioListen">Ascolta il riassunto completo</p>
                            <p class="text-sm text-teal-600" data-lang-key="audioDesc">Ideale per ripassare mentre sei in movimento.</p>
                        </div>
                        <a href="audio_broncopolmonite.mp3" download class="bg-gray-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-600 transition inline-flex items-center w-full sm:w-auto justify-center">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                            <span data-lang-key="btnDownloadAudio">Scarica</span>
                        </a>
                    </div>
                </section>

                <section id="bibliografia">
                    <h2 class="text-3xl font-bold text-teal-700 mb-4" data-lang-key="bibliographyTitle">Riferimenti Bibliografici</h2>
                    <ul class="list-disc pl-6 text-teal-900" data-lang-key="bibliographyContent">
                        <!-- Content loaded by JS -->
                    </ul>
                </section>
            </article>
            
            <div class="mt-12 text-center">
                <button id="print-button" onclick="window.print()" class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700 transition inline-flex items-center" data-lang-key="btnPrint">Stampa Riassunto</button>
            </div>
        </div>
    </main>
    <footer id="main-footer" class="text-center mt-16 pt-8 border-t border-slate-200">
        <p class="text-slate-500" data-lang-key="footer-credit">A cura della Prof.ssa Sara Busechian. Insegnamenti di clinica medica veterinaria</p>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const translations = {
                siteTitle: { it: "Patologie Respiratorie", en: "Respiratory Diseases" },
                backToIndexText: { it: "Indice Patologie Respiratorie", en: "Respiratory Pathology Index" },
                pageTitle: { it: "Broncopolmonite Infettiva", en: "Infectious Bronchopneumonia" },
                pageSubtitle: { it: "Gestione delle infezioni polmonari in diverse specie.", en: "Management of lung infections in different species." },
                navSummary: { it: "Riassunto", en: "Summary" },
                navInfographic: { it: "Infografica", en: "Infographic" },
                navQuiz: { it: "Quiz", en: "Quiz" },
                navAudio: { it: "Audio", en: "Audio" },
                navBibliography: { it: "Bibliografia", en: "Bibliography" },
                summaryTitle: { it: "Riassunto Completo", en: "Full Summary" },
                summaryContent: { 
                    it: `<p>La <strong>broncopolmonite infettiva</strong> √® un'infiammazione dei bronchi, bronchioli e alveoli polmonari causata da agenti patogeni. √à una delle patologie pi√π comuni in tutte le specie animali, con manifestazioni che variano a seconda dell'agente e dell'ospite.</p>
                         <h3 class="text-2xl font-semibold mt-6 mb-3">Eziologia</h3>
                         <p>L'eziologia √® spesso multifattoriale, con fattori predisponenti che aprono la strada a infezioni batteriche secondarie.</p>
                         <ul>
                            <li><strong>Fattori Predisponenti:</strong> Stress, trasporto, sovraffollamento, scarsa ventilazione, infezioni virali (es. Influenza Equina, EHV, IBR, BVD), aspirazione di materiale estraneo.</li>
                            <li><strong>Agenti Batterici Comuni:</strong>
                                <ul class="list-disc pl-5 mt-2">
                                    <li><strong>Cavallo Adulto:</strong> <em>Streptococcus equi zooepidemicus</em>, <em>Actinobacillus equuli</em>, <em>Klebsiella pneumoniae</em>, batteri anaerobi.</li>
                                    <li><strong>Puledro:</strong> <em>Rhodococcus equi</em> (causa una caratteristica broncopolmonite piogranulomatosa).</li>
                                    <li><strong>Bovino:</strong> <em>Mannheimia haemolytica</em>, <em>Pasteurella multocida</em>, <em>Histophilus somni</em> (parte del complesso BRD).</li>
                                    <li><strong>Cane e Gatto:</strong> <em>Bordetella bronchiseptica</em>, <em>Mycoplasma spp.</em>, <em>Streptococcus zooepidemicus</em>.</li>
                                </ul>
                            </li>
                         </ul>
                         <h3 class="text-2xl font-semibold mt-6 mb-3">Segni Clinici</h3>
                         <p>I segni clinici sono variabili ma includono quasi sempre:</p>
                         <ul class="list-disc pl-5 space-y-1 mt-2">
                            <li>Febbre, letargia, anoressia.</li>
                            <li>Tosse e scolo nasale (da sieroso a purulento).</li>
                            <li>Tachipnea (aumento della frequenza respiratoria) e dispnea.</li>
                            <li>All'auscultazione del torace: crepitii, sibili e aree di silenzio polmonare in caso di consolidamento o ascessi.</li>
                         </ul>
                         <div class="my-4 p-4 border rounded-lg bg-gray-50"><p class="text-sm font-semibold text-gray-700 mb-2">Puledro con polmonite da Rhodococcus</p><img src="rhodococcus_foal.jpg" alt="Puledro con distress respiratorio" class="w-full max-w-md mx-auto rounded-lg shadow-md"><p class="text-center text-xs text-gray-500 mt-1">Tipico atteggiamento di un puledro con polmonite grave.</p></div>
                         <h3 class="text-2xl font-semibold mt-6 mb-3">Diagnosi</h3>
                         <ul>
                            <li><strong>Esame clinico e anamnesi.</strong></li>
                            <li><strong>Esami del sangue:</strong> Mostrano segni di infiammazione (neutrofilia, iperfibrinogenemia).</li>
                            <li><strong>Ecografia Toracica:</strong> Gold standard per la visualizzazione del parenchima polmonare superficiale. Permette di identificare aree di consolidamento, ascessi e versamento pleurico.</li>
                            <li><strong>Campionamento delle vie aeree:</strong> Lavaggio Transtracheale (TTW) o Broncoalveolare (BAL) per esame citologico e colturale con antibiogramma, essenziale per una terapia mirata.</li>
                         </ul>
                         <div class="my-4 p-4 border rounded-lg bg-gray-50"><p class="text-sm font-semibold text-gray-700 mb-2">Ecografia polmonare in un cavallo</p><img src="lung_ultrasound.jpg" alt="Ecografia toracica in un cavallo" class="w-full max-w-md mx-auto rounded-lg shadow-md"><p class="text-center text-xs text-gray-500 mt-1">Immagine ecografica che mostra un ascesso polmonare.</p></div>
                         <h3 class="text-2xl font-semibold mt-6 mb-3">Terapia</h3>
                         <p>La terapia deve essere aggressiva e mirata.</p>
                         <ul>
                            <li><strong>Terapia Antibiotica:</strong> La scelta deve essere guidata dall'antibiogramma. 
                                <ul class="list-disc pl-5 mt-2">
                                    <li><strong>Grandi Animali:</strong> In attesa dei risultati, si imposta una terapia antibiotica ad ampio spettro (es. Penicillina + Gentamicina, Ceftiofur). Per <em>Rhodococcus equi</em>, la combinazione di un macrolide (es. Claritromicina) e Rifampicina √® la terapia d'elezione.</li>
                                    <li><strong>Piccoli Animali:</strong> Amoxicillina-acido clavulanico o Doxiciclina sono spesso usate come prima scelta in attesa dei risultati colturali.</li>
                                </ul>
                            </li>
                            <li><strong>Antinfiammatori (FANS):</strong> Per controllare febbre, dolore e infiammazione (es. Flunixin meglumine, Meloxicam).</li>
                            <li><strong>Terapia di Supporto:</strong> Fluidoterapia, ossigenoterapia (se necessario), supporto nutrizionale e riposo.</li>
                         </ul>`,
                    en: `<p><strong>Infectious bronchopneumonia</strong> is an inflammation of the bronchi, bronchioles, and pulmonary alveoli caused by pathogenic agents. It is one of the most common diseases across all animal species, with manifestations varying depending on the agent and the host.</p>
                         <h3 class="text-2xl font-semibold mt-6 mb-3">Etiology</h3>
                         <p>The etiology is often multifactorial, with predisposing factors paving the way for secondary bacterial infections.</p>
                         <ul>
                            <li><strong>Predisposing Factors:</strong> Stress, transport, overcrowding, poor ventilation, viral infections (e.g., Equine Influenza, EHV, IBR, BVD), aspiration of foreign material.</li>
                            <li><strong>Common Bacterial Agents:</strong>
                                <ul class="list-disc pl-5 mt-2">
                                    <li><strong>Adult Horse:</strong> <em>Streptococcus equi zooepidemicus</em>, <em>Actinobacillus equuli</em>, <em>Klebsiella pneumoniae</em>, anaerobic bacteria.</li>
                                    <li><strong>Foal:</strong> <em>Rhodococcus equi</em> (causes a characteristic pyogranulomatous bronchopneumonia).</li>
                                    <li><strong>Cattle:</strong> <em>Mannheimia haemolytica</em>, <em>Pasteurella multocida</em>, <em>Histophilus somni</em> (part of the BRD complex).</li>
                                    <li><strong>Dog and Cat:</strong> <em>Bordetella bronchiseptica</em>, <em>Mycoplasma spp.</em>, <em>Streptococcus zooepidemicus</em>.</li>
                                </ul>
                            </li>
                         </ul>
                         <h3 class="text-2xl font-semibold mt-6 mb-3">Clinical Signs</h3>
                         <p>Clinical signs are variable but almost always include:</p>
                         <ul class="list-disc pl-5 space-y-1 mt-2">
                            <li>Fever, lethargy, anorexia.</li>
                            <li>Cough and nasal discharge (from serous to purulent).</li>
                            <li>Tachypnea (increased respiratory rate) and dyspnea.</li>
                            <li>On chest auscultation: crackles, wheezes, and areas of silence in cases of consolidation or abscesses.</li>
                         </ul>
                         <div class="my-4 p-4 border rounded-lg bg-gray-50"><p class="text-sm font-semibold text-gray-700 mb-2">Foal with Rhodococcus pneumonia</p><img src="rhodococcus_foal.jpg" alt="Foal with respiratory distress" class="w-full max-w-md mx-auto rounded-lg shadow-md"><p class="text-center text-xs text-gray-500 mt-1">Typical posture of a foal with severe pneumonia.</p></div>
                         <h3 class="text-2xl font-semibold mt-6 mb-3">Diagnosis</h3>
                         <ul>
                            <li><strong>Clinical examination and history.</strong></li>
                            <li><strong>Blood tests:</strong> Show signs of inflammation (neutrophilia, hyperfibrinogenemia).</li>
                            <li><strong>Thoracic Ultrasound:</strong> Gold standard for visualizing the superficial lung parenchyma. It allows identification of consolidation areas, abscesses, and pleural effusion.</li>
                            <li><strong>Airway Sampling:</strong> Transtracheal Wash (TTW) or Bronchoalveolar Lavage (BAL) for cytology and culture with sensitivity testing, essential for targeted therapy.</li>
                         </ul>
                         <div class="my-4 p-4 border rounded-lg bg-gray-50"><p class="text-sm font-semibold text-gray-700 mb-2">Lung ultrasound in a horse</p><img src="lung_ultrasound.jpg" alt="Thoracic ultrasound in a horse" class="w-full max-w-md mx-auto rounded-lg shadow-md"><p class="text-center text-xs text-gray-500 mt-1">Ultrasound image showing a lung abscess.</p></div>
                         <h3 class="text-2xl font-semibold mt-6 mb-3">Therapy</h3>
                         <p>Therapy must be aggressive and targeted.</p>
                         <ul>
                            <li><strong>Antibiotic Therapy:</strong> The choice should be guided by antimicrobial susceptibility testing.
                                <ul class="list-disc pl-5 mt-2">
                                    <li><strong>Large Animals:</strong> While awaiting results, broad-spectrum antibiotic therapy is initiated (e.g., Penicillin + Gentamicin, Ceftiofur). For <em>Rhodococcus equi</em>, the combination of a macrolide (e.g., Clarithromycin) and Rifampin is the treatment of choice.</li>
                                    <li><strong>Small Animals:</strong> Amoxicillin-clavulanic acid or Doxycycline are often used as first-line therapy pending culture results.</li>
                                </ul>
                            </li>
                            <li><strong>Anti-inflammatory Drugs (NSAIDs):</strong> To control fever, pain, and inflammation (e.g., Flunixin meglumine, Meloxicam).</li>
                            <li><strong>Supportive Care:</strong> Fluid therapy, oxygen therapy (if necessary), nutritional support, and rest.</li>
                         </ul>`
                },
                infographicTitle: { it: "Infografica Riepilogativa", en: "Summary Infographic" },
                infographicLinkTitle: { it: "Visualizza l'Infografica Dettagliata", en: "View the Detailed Infographic" },
                infographicLinkDesc: { it: "Clicca qui per una guida visuale completa sulla broncopolmonite infettiva.", en: "Click here for a complete visual guide on infectious bronchopneumonia." },
                quizTitle: { it: "Quiz di Autovalutazione", en: "Self-Assessment Quiz" },
                quizSubmit: { it: "Verifica Risposte", en: "Check Answers" },
                audioTitle: { it: "Ascolta il Riassunto", en: "Listen to the Summary" },
                btnDownloadAudio: { it: "Scarica", en: "Download" },
                audioListen: { it: "Ascolta il riassunto completo", en: "Listen to the full summary" },
                audioDesc: { it: "Ideale per ripassare mentre sei in movimento.", en: "Ideal for reviewing on the go." },
                bibliographyTitle: { it: "Riferimenti Bibliografici", en: "Bibliographical References" },
                bibliographyContent: { 
                    it: `<li>Cot√© E, Ettinger SJ, Feldman EC, ETTINGER'S TEXTBOOK OF VETERINARY INTERNAL MEDICINE, 9¬∞ ed., Elsevier, 2024</li><li>Smith BP, Van Metre DC, Pusterla N, LARGE ANIMAL INTERNAL MEDICINE, 6th Edition, Elsevier, 2021</li><li>Constable PD, Hinchcliff KW, Done SH, Gr√ºnberg W, VETERINARY MEDICINE - A TEXTBOOK OF THE DISEASES OF CATTLE, HORSES, SHEEP, PIGS, AND GOATS, 11¬∞ ed., Elsevier, 2017</li><li>Reed SM, Bayly WM, Sellon DC, EQUINE INTERNAL MEDICINE, 4th Edition, Saunders, 2018</li>`,
                    en: `<li>Cot√© E, Ettinger SJ, Feldman EC, ETTINGER'S TEXTBOOK OF VETERINARY INTERNAL MEDICINE, 9th ed., Elsevier, 2024</li><li>Smith BP, Van Metre DC, Pusterla N, LARGE ANIMAL INTERNAL MEDICINE, 6th Edition, Elsevier, 2021</li><li>Constable PD, Hinchcliff KW, Done SH, Gr√ºnberg W, VETERINARY MEDICINE - A TEXTBOOK OF THE DISEASES OF CATTLE, HORSES, SHEEP, PIGS, AND GOATS, 11th ed., Elsevier, 2017</li><li>Reed SM, Bayly WM, Sellon DC, EQUINE INTERNAL MEDICINE, 4th Edition, Saunders, 2018</li>` 
                },
                btnPrint: { it: "Stampa Riassunto", en: "Print Summary" },
                accessibility: { it: "Accessibilit√†", en: "Accessibility" },
                "footer-credit": { it: "A cura della Prof.ssa Sara Busechian. Insegnamenti di clinica medica veterinaria", en: "Curated by Prof. Sara Busechian. Veterinary clinical medicine teachings" }
            };

            const quizData = {
                it: [
                    { question: "Qual √® il batterio pi√π comune nella polmonite dei cavalli adulti?", options: ["Rhodococcus equi", "Mannheimia haemolytica", "Streptococcus equi zooepidemicus", "Mycoplasma bovis"], answer: "Streptococcus equi zooepidemicus" },
                    { question: "La polmonite piogranulomatosa nei puledri √® tipicamente causata da:", options: ["Streptococcus equi", "Pasteurella multocida", "Rhodococcus equi", "Bordetella bronchiseptica"], answer: "Rhodococcus equi" },
                    { question: "Quale fattore √® considerato il principale predisponente per la broncopolmonite batterica?", options: ["Dieta", "Genetica", "Stress o infezione virale pregressa", "Et√† avanzata"], answer: "Stress o infezione virale pregressa" },
                    { question: "Qual √® il metodo diagnostico 'gold standard' per identificare l'agente batterico in una polmonite?", options: ["Esame del sangue", "Radiografia toracica", "Lavaggio transtracheale con esame colturale", "Auscultazione"], answer: "Lavaggio transtracheale con esame colturale" },
                    { question: "La presenza di 'rantoli' all'auscultazione del torace indica:", options: ["Restringimento bronchiale", "Fluido nei bronchi", "Infiammazione pleurica", "Aria nello spazio pleurico"], answer: "Fluido nei bronchi" },
                    { question: "Quale strumento √® pi√π efficace per visualizzare ascessi polmonari superficiali?", options: ["Endoscopio", "Ecografo", "Radiografo", "Stetoscopio"], answer: "Ecografo" },
                    { question: "La terapia d'elezione per Rhodococcus equi nei puledri √®:", options: ["Penicillina e Gentamicina", "Ossitetraciclina", "Macrolide e Rifampicina", "Solo FANS"], answer: "Macrolide e Rifampicina" },
                    { question: "Cosa indica un'iperfibrinogenemia in un esame del sangue?", options: ["Un'infezione virale acuta", "Un processo infiammatorio cronico o infezione batterica", "Anemia", "Stress"], answer: "Un processo infiammatorio cronico o infezione batterica" },
                    { question: "Quale dei seguenti NON √® un fattore di stress comunemente associato a broncopolmonite?", options: ["Trasporto", "Svezzamento", "Pascolo in ampi spazi", "Sovraffollamento"], answer: "Pascolo in ampi spazi" },
                    { question: "I FANS (es. Flunixin) vengono utilizzati nella terapia della broncopolmonite per:", options: ["Uccidere i batteri", "Fluidificare il muco", "Ridurre febbre e infiammazione", "Prevenire infezioni virali"], answer: "Ridurre febbre e infiammazione" }
                ],
                en: [
                    { question: "What is the most common bacterium in adult horse pneumonia?", options: ["Rhodococcus equi", "Mannheimia haemolytica", "Streptococcus equi zooepidemicus", "Mycoplasma bovis"], answer: "Streptococcus equi zooepidemicus" },
                    { question: "Pyogranulomatous pneumonia in foals is typically caused by:", options: ["Streptococcus equi", "Pasteurella multocida", "Rhodococcus equi", "Bordetella bronchiseptica"], answer: "Rhodococcus equi" },
                    { question: "What is considered the main predisposing factor for bacterial bronchopneumonia?", options: ["Diet", "Genetics", "Stress or a prior viral infection", "Advanced age"], answer: "Stress or a prior viral infection" },
                    { question: "What is the 'gold standard' diagnostic method for identifying the bacterial agent in pneumonia?", options: ["Blood test", "Thoracic radiography", "Transtracheal wash with culture", "Auscultation"], answer: "Transtracheal wash with culture" },
                    { question: "The presence of 'crackles' on chest auscultation indicates:", options: ["Bronchial narrowing", "Fluid in the alveoli", "Pleural inflammation", "Air in the pleural space"], answer: "Fluid in the alveoli" },
                    { question: "Which tool is most effective for visualizing superficial lung abscesses?", options: ["Endoscope", "Ultrasound", "X-ray", "Stethoscope"], answer: "Ultrasound" },
                    { question: "The treatment of choice for Rhodococcus equi in foals is:", options: ["Penicillin and Gentamicin", "Oxytetracycline", "A macrolide and Rifampin", "NSAIDs only"], answer: "A macrolide and Rifampin" },
                    { question: "What does hyperfibrinogenemia in a blood test indicate?", options: ["An acute viral infection", "A chronic inflammatory process or bacterial infection", "Anemia", "Stress"], answer: "A chronic inflammatory process or bacterial infection" },
                    { question: "Which of the following is NOT a stress factor commonly associated with bronchopneumonia?", options: ["Transport", "Weaning", "Grazing in large pastures", "Overcrowding"], answer: "Grazing in large pastures" },
                    { question: "NSAIDs (e.g., Flunixin) are used in the therapy of bronchopneumonia to:", options: ["Kill bacteria", "Liquefy mucus", "Reduce fever and inflammation", "Prevent viral infections"], answer: "Reduce fever and inflammation" }
                ]
            };
            
            let currentLanguage = localStorage.getItem('language') || 'it';
            
            const synth = window.speechSynthesis;
            let currentUtterance = null;
            let activeTTSButton = null;

            function speak(text, button) {
                if (activeTTSButton === button && currentUtterance) {
                    if (synth.paused) {
                        synth.resume();
                        button.classList.add('playing');
                    } else if (synth.speaking) {
                        synth.pause();
                        button.classList.remove('playing');
                    }
                    return; 
                }

                if (synth.speaking || synth.paused) {
                    synth.cancel();
                }
                
                if(activeTTSButton) {
                    activeTTSButton.classList.remove('playing');
                }

                currentUtterance = new SpeechSynthesisUtterance(text);
                currentUtterance.lang = currentLanguage === 'it' ? 'it-IT' : 'en-US';
                
                const cleanup = () => {
                    if(activeTTSButton) activeTTSButton.classList.remove('playing');
                    activeTTSButton = null;
                    currentUtterance = null;
                };

                currentUtterance.onend = cleanup;

                currentUtterance.onerror = (event) => {
                    console.error('An error occurred with speech synthesis:', event.error);
                    cleanup();
                };

                activeTTSButton = button;
                button.classList.add('playing');
                synth.speak(currentUtterance);
            }


            let sound = null;

            function initHowler() {
                sound = new Howl({
                    src: ['audio_broncopolmonite.mp3'],
                    html5: true, 
                    onplay: () => { playIcon.classList.add('hidden'); pauseIcon.classList.remove('hidden'); },
                    onpause: () => { playIcon.classList.remove('hidden'); pauseIcon.classList.add('hidden'); },
                    onend: () => { playIcon.classList.remove('hidden'); pauseIcon.classList.add('hidden'); },
                    onloaderror: (id, msg) => {
                        console.error("Error loading audio:", msg);
                        const audioDesc = document.querySelector('[data-lang-key="audioDesc"]');
                        if (audioDesc) audioDesc.textContent = "Errore nel caricamento del file audio.";
                    },
                    onplayerror: (id, msg) => {
                        console.error("Error playing audio:", msg);
                        const audioDesc = document.querySelector('[data-lang-key="audioDesc"]');
                        if (audioDesc) audioDesc.textContent = "Impossibile riprodurre il file audio.";
                    }
                });
            }

            const playPauseBtn = document.getElementById('audio-play-pause');
            const playIcon = document.getElementById('play-icon');
            const pauseIcon = document.getElementById('pause-icon');

            playPauseBtn.addEventListener('click', () => {
                if (!sound) initHowler();
                if (sound.playing()) sound.pause(); else sound.play();
            });

            function setupTTSListeners() {
                document.querySelectorAll('.tts-button').forEach(button => {
                    const newButton = button.cloneNode(true);
                    button.parentNode.replaceChild(newButton, button);
                    newButton.addEventListener('click', (e) => {
                        e.stopPropagation();
                        let textToRead = '';
                        const parentElement = newButton.parentElement;
                        if (parentElement.tagName === 'H2') {
                            const section = parentElement.closest('section');
                            let contentToRead = '';
                            if(section){
                                const clone = section.cloneNode(true);
                                clone.querySelectorAll('h2, button, a, img, audio, .tts-button, #quiz, #infografica, #audio, #bibliografia').forEach(el => el.remove());
                                contentToRead = clone.textContent.trim().replace(/\s\s+/g, ' ');
                            }
                            const titleClone = parentElement.cloneNode(true);
                            titleClone.querySelector('.tts-button').remove();
                            textToRead = `${titleClone.textContent.trim()}. ${contentToRead}`;
                        } 
                        else if (parentElement.tagName === 'H3') {
                               const questionTextNode = parentElement.querySelector('span:first-child');
                               if (questionTextNode) textToRead = questionTextNode.textContent.trim().replace(/^\d+\.\s*/, '');
                        }
                        else if (parentElement.closest('label')) {
                            const label = parentElement.closest('label');
                            const answerTextNode = label.querySelector('span:first-child');
                            if (answerTextNode) textToRead = answerTextNode.textContent.trim();
                        }
                        if (textToRead) speak(textToRead, newButton);
                    });
                });
            }

            function loadQuiz(lang) {
                const quizContainer = document.getElementById('quiz-container');
                quizContainer.innerHTML = '';
                document.getElementById('quiz-results').innerHTML = ''; 
                quizData[lang].forEach((q, index) => {
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'quiz-question p-4 rounded-lg';
                    let optionsHtml = q.options.map(o => `
                        <li class="quiz-option p-2 rounded hover:bg-teal-50">
                            <label class="flex items-center justify-between w-full cursor-pointer">
                                <span class="flex-grow pr-4"><input type="radio" name="q${index}" value="${o}" class="mr-3">${o}</span>
                                <span class="tts-button flex-shrink-0"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.414z"/></svg></span>
                            </label>
                        </li>`).join('');
                    questionDiv.innerHTML = `<h3 class="font-semibold mb-2 flex items-center justify-between"><span>${index + 1}. ${q.question}</span><span class="tts-button"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.414z"/></svg></span></h3><ul class="space-y-1">${optionsHtml}</ul>`;
                    quizContainer.appendChild(questionDiv);
                });
            }

            function updateLanguage(lang) {
                document.documentElement.lang = lang;
                document.getElementById('lang-toggle').textContent = lang === 'it' ? 'EN' : 'IT';
                document.querySelectorAll('[data-lang-key]').forEach(element => {
                    const key = element.dataset.langKey;
                    if (translations[key] && translations[key][lang]) {
                        if (key.includes('Content')) {
                                element.innerHTML = translations[key][lang];
                        } else {
                            const ttsButton = element.querySelector('.tts-button');
                            element.textContent = translations[key][lang];
                            if(ttsButton) element.appendChild(ttsButton);
                        }
                    }
                });
                
                const navAudio = document.querySelector('a[data-lang-key="navAudio"]');
                const sectionAudio = document.getElementById('audio');
                if (lang === 'en') {
                    if(navAudio) navAudio.style.display = 'none';
                    if(sectionAudio) sectionAudio.style.display = 'none';
                } else {
                    if(navAudio) navAudio.style.display = 'block';
                    if(sectionAudio) sectionAudio.style.display = 'block';
                }

                const dsaToggle = document.getElementById('accessibility-toggle');
                if (document.body.classList.contains('dsa-mode')) {
                    dsaToggle.textContent = lang === 'it' ? 'Vista Standard' : 'Standard View';
                } else {
                    dsaToggle.textContent = lang === 'it' ? 'Accessibilit√†' : 'Accessibility';
                }
                loadQuiz(lang);
                setupTTSListeners();
            }
            
            document.getElementById('lang-toggle').addEventListener('click', () => {
                currentLanguage = currentLanguage === 'it' ? 'en' : 'it';
                localStorage.setItem('language', currentLanguage);
                updateLanguage(currentLanguage);
            });

            const dsaToggle = document.getElementById('accessibility-toggle');
            dsaToggle.addEventListener('click', () => {
                document.body.classList.toggle('dsa-mode');
                 if (document.body.classList.contains('dsa-mode')) {
                    dsaToggle.textContent = currentLanguage === 'it' ? 'Vista Standard' : 'Standard View';
                } else {
                    dsaToggle.textContent = currentLanguage === 'it' ? 'Accessibilit√†' : 'Accessibility';
                }
            });

            document.getElementById('submit-quiz').addEventListener('click', () => {
                let score = 0;
                const questions = document.querySelectorAll('.quiz-question');
                quizData[currentLanguage].forEach((q, index) => {
                    const selected = document.querySelector(`input[name="q${index}"]:checked`);
                    questions[index].classList.remove('correct', 'incorrect');
                    if (selected) {
                        if (selected.value === q.answer) {
                            score++;
                            questions[index].classList.add('correct');
                        } else {
                            questions[index].classList.add('incorrect');
                        }
                    } else {
                        questions[index].classList.add('incorrect');
                    }
                });
                const resultsContainer = document.getElementById('quiz-results');
                const resultText = {
                    it: `Hai risposto correttamente a ${score} su ${quizData.it.length} domande.`,
                    en: `You answered ${score} out of ${quizData.en.length} questions correctly.`
                };
                resultsContainer.textContent = resultText[currentLanguage];
            });
            
            // Initial setup
            updateLanguage(currentLanguage);
        });
    </script>
</body>
</html>

